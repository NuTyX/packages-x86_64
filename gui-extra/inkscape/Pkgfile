description='Professional vector graphics editor'
url='https://inkscape.org/'

license="GPL2 GPL3 LGPL2 LGPL3 MPL OFL"
packager="spiky <spiky@nutyx.org>"
contributors="Tnut"

name=inkscape
version=1.3

source=(https://inkscape.org/gallery/item/42328/$name-$version.tar.xz
        poppler-22.09.0.patch)

makedepends=(cmake boost git gtkmm python lcms2 gsl libxslt gc
             dbus-glib lcms2 libjpeg-turbo poppler-glib gspell
             graphicsmagick libsoup double-conversion potrace
             librevenge libcdr gzip readline jemalloc)
run=(desktop-file-utils hicolor-icon-theme gtk-update-icon-cache
     shared-mime-info)

prepare() {
	mv $name-$version* $name
	cd $name

}

build() {

	mkdir -p build
	export PKG_CONFIG_PATH='/usr/lib/imagemagick6/pkgconfig'
	cmake -H${name} -Bbuild \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX:PATH=/usr \
		-DWITH_DBUS=ON \

	cmake --build build
}

package() {
	DESTDIR=$PKG cmake --build build --target install

install -Dm644 $name/COPYING $PKG/usr/share/licenses/$name/COPYING
install -Dm644 $name/LICENSES/* $PKG/usr/share/licenses/$name/
}

