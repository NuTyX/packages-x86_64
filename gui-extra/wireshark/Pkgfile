description="Network Sniffer with nice GUI"
url="http://www.wireshark.org"

packager="Tnut <tnut@nutyx.org>"
contributors="Fanch,Greg,RÃ©my,Fabienwang,Spiky"

makedepends=(cmake c-ares ninja gtk3 libpcap pcre qtbase gnutls 
             qttranslations qtmultimedia qtsvg qttools libssh libgcrypt)
run=(shared-mime-info hicolor-icon-theme)


name=wireshark
version=4.0.2

source=(https://www.wireshark.org/download/src/$name-$version.tar.xz)

prepare() {
getent group wireshark ||groupadd -g 62 wireshark
}
build() {

  mkdir build
  cd    build
  cmake  -DCMAKE_INSTALL_PREFIX=/usr \
         -DCMAKE_BUILD_TYPE=Release \
         -DCMAKE_INSTALL_LIBDIR=lib \
         -DCMAKE_INSTALL_RPATH= \
         -DCMAKE_SKIP_RPATH=ON \
         -G Ninja ../$name-$version

  ninja
  DESTDIR=$PKG ninja install

  chmod -v 6550 $PKG/usr/bin/{tshark,dumpcap}
}
