description="GNOME Password Management daemon"
url="http://www.gnome.org/"

packager="Spiky <spiky@nutyx.org>"
contributors="Fanch,Jayce,Tnut,Spiky"

makedepends=(dbus gcr pam libxslt libcap-ng gnupg openssh valgrind)

name=gnome-keyring
version=42.0
release=2

source=(https://gitlab.gnome.org/GNOME/$name/-/archive/42.0/$name-$version.tar.gz)

prepare() {
cd $name-$version
NOCONFIGURE=1 ./autogen.sh
}

build() {
cd $name-$version

./configure --prefix=/usr \
    --sysconfdir=/etc \
    --localstatedir=/var \
    --libexecdir=/usr/lib \
    --with-pam-dir=/lib/security \
    --disable-static \
    --disable-schemas-compile
make
make DESTDIR=$PKG install


# Obsolets libs
rm $PKG/usr/lib/gnome-keyring/devel/gkm-gnome2-store-standalone.la
rm $PKG/usr/lib/gnome-keyring/devel/gkm-secret-store-standalone.la
rm $PKG/usr/lib/gnome-keyring/devel/gkm-ssh-store-standalone.la
rm $PKG/usr/lib/gnome-keyring/devel/gkm-xdg-store-standalone.la
rm $PKG/usr/lib/pkcs11/gnome-keyring-pkcs11.la
rm $PKG/lib/security/pam_gnome_keyring.la
}
