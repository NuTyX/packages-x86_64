# Depends on: gstreamer alsa-lib gobject-introspection iso-codes libtheora libvorbis pango mesa

description="GStreamer Multimedia Framework Base Plugins"
url="http://gstreamer.freedesktop.org/"
packager="tnut <tnut@nutyx.org>"
contributors="Pierre B"

_name=gst-plugins-base 

name=gstreamer-plugins-base
version=1.14.4
release=2

source=(http://gstreamer.freedesktop.org/src/${_name}/${_name}-$version.tar.xz)

build() {
cd ${_name}-$version
./configure --prefix=/usr \
--with-package-name="GStreamer Base Plugins $version NuTyX" \
--with-package-origin="http://downloads.nutyx.org/"
make
make DESTDIR=$PKG install

# Obsolets libs
rm $PKG/usr/lib/gstreamer-1.0/libgstadder.la
rm $PKG/usr/lib/gstreamer-1.0/libgstalsa.la
rm $PKG/usr/lib/gstreamer-1.0/libgstapp.la
rm $PKG/usr/lib/gstreamer-1.0/libgstaudioconvert.la
rm $PKG/usr/lib/gstreamer-1.0/libgstaudiomixer.la
rm $PKG/usr/lib/gstreamer-1.0/libgstaudiorate.la
rm $PKG/usr/lib/gstreamer-1.0/libgstaudioresample.la
rm $PKG/usr/lib/gstreamer-1.0/libgstaudiotestsrc.la
rm $PKG/usr/lib/gstreamer-1.0/libgstencoding.la
rm $PKG/usr/lib/gstreamer-1.0/libgstgio.la
rm $PKG/usr/lib/gstreamer-1.0/libgstogg.la
rm $PKG/usr/lib/gstreamer-1.0/libgstpango.la
rm $PKG/usr/lib/gstreamer-1.0/libgstpbtypes.la
rm $PKG/usr/lib/gstreamer-1.0/libgstplayback.la
rm $PKG/usr/lib/gstreamer-1.0/libgstrawparse.la
rm $PKG/usr/lib/gstreamer-1.0/libgstsubparse.la
rm $PKG/usr/lib/gstreamer-1.0/libgsttcp.la
rm $PKG/usr/lib/gstreamer-1.0/libgsttheora.la
rm $PKG/usr/lib/gstreamer-1.0/libgsttypefindfunctions.la
rm $PKG/usr/lib/gstreamer-1.0/libgstvideoconvert.la
rm $PKG/usr/lib/gstreamer-1.0/libgstvideorate.la
rm $PKG/usr/lib/gstreamer-1.0/libgstvideoscale.la
rm $PKG/usr/lib/gstreamer-1.0/libgstvideotestsrc.la
rm $PKG/usr/lib/gstreamer-1.0/libgstvolume.la
rm $PKG/usr/lib/gstreamer-1.0/libgstvorbis.la
rm $PKG/usr/lib/gstreamer-1.0/libgstximagesink.la
rm $PKG/usr/lib/gstreamer-1.0/libgstopengl.la
rm $PKG/usr/lib/libgstgl-1.0.la
rm $PKG/usr/lib/libgstallocators-1.0.la
rm $PKG/usr/lib/libgstapp-1.0.la
rm $PKG/usr/lib/libgstaudio-1.0.la
rm $PKG/usr/lib/libgstfft-1.0.la
rm $PKG/usr/lib/libgstpbutils-1.0.la
rm $PKG/usr/lib/libgstriff-1.0.la
rm $PKG/usr/lib/libgstrtp-1.0.la
rm $PKG/usr/lib/libgstrtsp-1.0.la
rm $PKG/usr/lib/libgstsdp-1.0.la
rm $PKG/usr/lib/libgsttag-1.0.la
rm $PKG/usr/lib/libgstvideo-1.0.la
} 
uptodate() {
local url ext
name=${_name}
url="https://gstreamer.freedesktop.org/src/$name/"
ext=".tar.xz"
lynx -read_timeout=20 -dump -listonly -nonumbers \
$url|grep $name-[0-9]|grep $ext$|sed "s@$url$name-@@"|sed "s@$ext@@"|tail -1
}
