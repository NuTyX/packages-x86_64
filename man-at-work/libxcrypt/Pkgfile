description='Modern library for one-way hashing of passwords'
url='https://github.com/besser82/libxcrypt/'

license='LGPL'

packager="tnut <tnut@nutyx.org>"
contributors="Spiky"

makedepends=(pkgconf glibc perl)

name=libxcrypt
version=4.4.36
release=2

source=(https://github.com/besser82/libxcrypt/releases/download/v$version/$name-$version.tar.xz)

build() {
cd $name-$version
./configure --prefix=/usr                \
            --enable-hashes=strong,glibc \
            --enable-obsolete-api=no     \
            --disable-static             \
            --disable-failure-tokens

make
make DESTDIR=$PKG install

# usr/include/crypt.h is part of glibc.devel for the moment
# Need to findout why it's in this package as well
#

mkdir $PKG/usr/include/$name
mv $PKG/usr/include/crypt.h \
$PKG/usr/include/$name/crypt.h

# Required for binutils
#

make distclean
./configure --prefix=/usr                \
            --enable-hashes=strong,glibc \
            --enable-obsolete-api=glibc  \
            --disable-static             \
            --disable-failure-tokens
make
cp -av .libs/libcrypt.so.1* $PKG/usr/lib

install -Dm644 LICENSING $PKG/usr/share/licenses/$name/LICENSING

}

